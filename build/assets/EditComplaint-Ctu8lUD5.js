import{y,r as x,u as F,j as e}from"./index-DQvjgStD.js";import{A as _,b as w}from"./DocsExample-6Vxn7Boi.js";import{A as D}from"./AppHeader-Cc2NvxR0.js";import"./index.es-yNj0I_EF.js";import{e as j,f as N,d as f,u as S}from"./sweetalert2.all-DTvVwEbb.js";import{C as E,a as P}from"./CRow-DEtUDQdQ.js";import{C as R,a as I}from"./CCardBody-DpEnljuq.js";import{C as L}from"./CCardHeader-CF2iSJq9.js";import{C as O}from"./CForm-D4vaX_Kw.js";import{C as d}from"./CFormLabel-k4HiOGpI.js";import{C as h}from"./CFormInput-DG2ux7NO.js";import{C as T}from"./CFormTextarea-Eu6Q0uzy.js";import{C as q}from"./CFormSelect-ChP6AOGL.js";import{C as k}from"./CButton-DqYmZECj.js";import"./CContainer-B4pb1IMo.js";import"./useForkedRef-JzaBuqs-.js";import"./CDropdownToggle-crj6rjNT.js";import"./CConditionalPortal-BS2K3NAO.js";import"./isRTL-DaGrxY3a.js";import"./CAvatar-DpfiiHi1.js";import"./cil-lock-locked-DmxpJbVL.js";import"./cil-sun-CiqFXe3L.js";import"./cil-moon-BFUMwZPK.js";import"./CFormControlWrapper-Dd1i6Esi.js";import"./CFormControlValidation-Dj7B0drr.js";const p={_origin:"https://api.emailjs.com"},A=(s,t="https://api.emailjs.com")=>{p._userID=s,p._origin=t},C=(s,t,o)=>{if(!s)throw"The user ID is required. Visit https://dashboard.emailjs.com/admin/integration";if(!t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!o)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class g{constructor(t){this.status=t.status,this.text=t.responseText}}const v=(s,t,o={})=>new Promise((l,r)=>{const n=new XMLHttpRequest;n.addEventListener("load",({target:i})=>{const c=new g(i);c.status===200||c.text==="OK"?l(c):r(c)}),n.addEventListener("error",({target:i})=>{r(new g(i))}),n.open("POST",p._origin+s,!0),Object.keys(o).forEach(i=>{n.setRequestHeader(i,o[i])}),n.send(t)}),H=(s,t,o,l)=>{const r=l||p._userID;return C(r,s,t),v("/api/v1.0/email/send",JSON.stringify({lib_version:"3.2.0",user_id:r,service_id:s,template_id:t,template_params:o}),{"Content-type":"application/json"})},U=s=>{let t;if(typeof s=="string"?t=document.querySelector(s):t=s,!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return t},J=(s,t,o,l)=>{const r=l||p._userID,n=U(o);C(r,s,t);const i=new FormData(n);return i.append("lib_version","3.2.0"),i.append("service_id",s),i.append("template_id",t),i.append("user_id",r),v("/api/v1.0/email/send-form",i)},M={init:A,send:H,sendForm:J},he=()=>{const{id:s}=y(),[t,o]=x.useState({title:"",email:"",instansi:"",date:"",report:"",status:"",imageURL:""}),l=F();x.useEffect(()=>{(async()=>{const a=j(f,"Complaint",s),u=await N(a);u.exists()?o(u.data()):console.log("No such document!")})()},[s]);const r=m=>{const{id:a,value:u}=m.target;o(b=>({...b,[a]:u}))},n=async m=>{m.preventDefault();try{const a=j(f,"Complaint",s);await S(a,t),alert("Data updated successfully!"),console.log(i(),"email"),l("/pengaduan")}catch(a){console.error("Error updating document:",a)}},i=()=>{const m={to_email:t.email,complaint_title:t.title,complaint_status:t.status};M.send("service_mdatdqr","template_lx9kksa",m,"-u7qOKJd_7fZ5JMil").then(a=>{console.log("Email successfully sent!",a.status,a.text)}).catch(a=>{console.error("Failed to send email. Error: ",a)})},c=m=>{const a=document.createElement("a");a.href=m,a.setAttribute("download","image.jpg"),document.body.appendChild(a),a.click(),document.body.removeChild(a)};return e.jsxs("div",{children:[e.jsx(_,{}),e.jsxs("div",{className:"wrapper d-flex flex-column min-vh-100",children:[e.jsx(D,{}),e.jsx("div",{className:"body flex-grow-1",children:e.jsx(E,{children:e.jsx(P,{xs:12,style:{marginLeft:"2.5rem"},children:e.jsxs(R,{className:"mb-4",style:{width:"95%"},children:[e.jsx(L,{children:e.jsx("strong",{children:"Edit Status Pengaduan"})}),e.jsx(I,{children:e.jsxs(O,{onSubmit:n,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"exampleFormControlInput1",children:"Judul Pengaduan"}),e.jsx(h,{type:"text",id:"title",value:t.title,onChange:r,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"exampleFormControlInput1",children:"Email User"}),e.jsx(h,{type:"text",id:"email",value:t.email,onChange:r,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"exampleFormControlInput1",children:"Nama Perusahaan"}),e.jsx(h,{type:"text",id:"instansi",value:t.instansi,onChange:r,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"exampleFormControlInput1",children:"Tanggal Pengaduan"}),e.jsx(h,{type:"text",id:"date",value:t.date,onChange:r,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"exampleFormControlTextarea1",children:"Deskripsi Pengaduan"}),e.jsx(T,{id:"report",rows:3,value:t.report,onChange:r,readOnly:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"status",children:"Status Pengaduan"}),e.jsxs(q,{id:"status",value:t.status,onChange:r,children:[e.jsx("option",{value:"Diterima",children:"Diterima"}),e.jsx("option",{value:"Diproses",children:"Diproses"}),e.jsx("option",{value:"Selesai",children:"Selesai"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(d,{htmlFor:"image",children:"Gambar Pengaduan"}),t.imageURL&&e.jsxs("div",{children:[e.jsx("img",{id:"fullScreenImage",src:t.imageURL,alt:"Complaint",style:{width:"300px",cursor:"pointer",marginRight:"1rem"}}),e.jsx(k,{color:"primary",onClick:()=>c(t.imageURL),children:"lihat image"})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Update"})]})})]})})})}),e.jsx(w,{})]})]})};export{he as default};
